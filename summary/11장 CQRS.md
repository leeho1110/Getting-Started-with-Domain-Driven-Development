# 11장: CQRS

- 시스템은 크게 조회와 상태를 변경하는 두 가지 기능을 제공한다.
    - 도메인 모델 관점에서 상태 변경 기능은 주로 단일 애그리거트의 상태를 변경하는 형태다. 반면 조회는 여러 애그리거트를 필요로 한다.
    - 즉 상태를 변경하는 범위와 조회하는 범위가 서로 달라 단일 모델로 이를 구현하면 모델이 복잡해진다.
    - 이를 위해 등장한 방법이 바로 **Command Query Responsibility Segregation, CQRS** 이다.
- CQRS 구조를 띄게 되면 조회 모델에는 응용 서비스 계층없이 바로 DAO를 컨트롤러에서 호출한다.
    - 또한 조회 모델과 명령 모델에서 서로 다른 액세스 기술을 사용할 수 있다. 상태 변경에는 JPA, 조회 모델에는 MyBatis와 같은 형식도 가능하다. RDB, NoSQL로 변경하는 것 역시 가능하다.
    - 만약 RDB, NoSQL 형태로 데이터 저장소가 다른 경우 이벤트를 통해 데이터를 동기화시키면 된다.
- CQRS로 얻는 첫 번째 장점은 명령 모델을 구현 시 도메인 자체에 집중할 수 있다는 점이다. 또한 조회 성능을 향상시키는 데에도 유리하다. 물론 구현이 복잡하다는 단점 역시 중요하다.
    - 도메인의 복잡함 혹은 트래픽의 고저를 적절하게 판단해 CQRS를 도입하자.